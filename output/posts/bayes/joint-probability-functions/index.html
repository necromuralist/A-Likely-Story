<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="Looking at Joint Probability Functions." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Joint Probability Functions | A Likely Story</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../../rss.xml" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/A-Likely-Story/posts/bayes/joint-probability-functions/" rel="canonical"><!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]-->
<link href="../../../apple-icon-57x57.png" rel="apple-touch-icon" sizes="57x57">
<link href="../../../apple-icon-60x60.png" rel="apple-touch-icon" sizes="60x60">
<link href="../../../apple-icon-72x72.png" rel="apple-touch-icon" sizes="72x72">
<link href="../../../apple-icon-76x76.png" rel="apple-touch-icon" sizes="76x76">
<link href="../../../apple-icon-114x114.png" rel="apple-touch-icon" sizes="114x114">
<link href="../../../apple-icon-120x120.png" rel="apple-touch-icon" sizes="120x120">
<link href="../../../apple-icon-144x144.png" rel="apple-touch-icon" sizes="144x144">
<link href="../../../apple-icon-152x152.png" rel="apple-touch-icon" sizes="152x152">
<link href="../../../apple-icon-180x180.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../../android-icon-192x192.png" rel="icon" sizes="192x192" type="image/png">
<link href="../../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../../favicon-96x96.png" rel="icon" sizes="96x96" type="image/png">
<link href="../../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../../manifest.json" rel="manifest">
<meta content="#ffffff" name="msapplication-TileColor">
<meta content="/ms-icon-144x144.png" name="msapplication-TileImage">
<meta content="#ffffff" name="theme-color">
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>
<meta content="Cloistered Monkey" name="author">
<link href="../the-pox-probabilities/" rel="prev" title="The Pox Probabilities" type="text/html">
<link href="../../interesting-sources/" rel="next" title="Interesting Sources" type="text/html">
<meta content="A Likely Story" property="og:site_name">
<meta content="Joint Probability Functions" property="og:title">
<meta content="https://necromuralist.github.io/A-Likely-Story/posts/bayes/joint-probability-functions/" property="og:url">
<meta content="Looking at Joint Probability Functions." property="og:description">
<meta content="article" property="og:type">
<meta content="2019-06-12T12:33:59-07:00" property="article:published_time">
<meta content="bayes" property="article:tag">
<meta content="probability" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="https://necromuralist.github.io/A-Likely-Story/"><span id="blog-title">A Likely Story</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="../../../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../../../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../../../rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Pages</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/">Cloistered Monkey</a></div>
</li>
</ul>
<!-- DuckDuckGo custom search -->
<form action="https://duckduckgo.com/" class="navbar-form pull-left" id="search" method="get" name="search"><input name="sites" type="hidden" value="https://necromuralist.github.io/A-Likely-Story/"><input name="k8" type="hidden" value="#444444"><input name="k9" type="hidden" value="#D51920"><input name="kt" type="hidden" value="h"><input class="span2" maxlength="255" name="q" placeholder="Searchâ€¦" type="text"><input style="visibility: hidden;display:none" type="submit" value="DuckDuckGo Search"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href=".">Joint Probability Functions</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2019-06-12T12:33:59-07:00" itemprop="datePublished" title="2019-06-12 12:33">2019-06-12 12:33</time></a></p>
<p class="sourceline"><a class="sourcelink" href="index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org79e7b4e">Beginning</a>
<ul>
<li><a href="#org5e16960">Imports</a></li>
<li><a href="#org930da04">The Plotting</a></li>
</ul>
</li>
<li><a href="#orgd0c1d24">Middle</a>
<ul>
<li><a href="#org6a40de0">The Joint Probability Function</a></li>
<li><a href="#orgac78b13">Diseases And Symptoms</a></li>
<li><a href="#org6c53bf9">The Probability</a></li>
<li><a href="#orgb1f35a6">Visualize the Maximum A-Priori</a></li>
</ul>
</li>
<li><a href="#orgfe91eaa">End</a>
<ul>
<li><a href="#org1bcd5e1">Tests</a></li>
<li><a href="#org9992488">Source</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org79e7b4e">
<h2 id="org79e7b4e">Beginning</h2>
<div class="outline-text-2" id="text-org79e7b4e">
<p>This is another re-working of an example from <a href="http://jim-stone.staff.shef.ac.uk/BookBayes2012/BayesRuleBookMain.html">Bayes' Rule: A Tutorial Introduction to Bayesian Analysis</a>. This looks at the case where we have more than one input and more than one possible output value. This assumes the possible outputs are discrete.</p>
</div>
<div class="outline-3" id="outline-container-org5e16960">
<h3 id="org5e16960">Imports</h3>
<div class="outline-text-3" id="text-org5e16960"></div>
<div class="outline-4" id="outline-container-org0c0768a">
<h4 id="org0c0768a">Python</h4>
<div class="outline-text-4" id="text-org0c0768a">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">argparse</span> <span class="kn">import</span> <span class="n">Namespace</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">isclose</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">random</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org39ac0a7">
<h4 id="org39ac0a7">PyPi</h4>
<div class="outline-text-4" id="text-org39ac0a7">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">HoverTool</span>
<span class="kn">from</span> <span class="nn">expects</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">be</span><span class="p">,</span>
    <span class="n">be_true</span><span class="p">,</span>
    <span class="n">equal</span><span class="p">,</span>
    <span class="n">expect</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">hypothesis</span> <span class="kn">import</span> <span class="n">given</span>
<span class="kn">from</span> <span class="nn">hypothesis.extra.pandas</span> <span class="kn">import</span> <span class="n">columns</span><span class="p">,</span> <span class="n">data_frames</span><span class="p">,</span> <span class="n">range_indexes</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">import</span> <span class="nn">holoviews</span>
<span class="kn">import</span> <span class="nn">pandas</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org5a668fd">
<h4 id="org5a668fd">My Stuff</h4>
<div class="outline-text-4" id="text-org5a668fd">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">graeae.visualization</span> <span class="kn">import</span> <span class="n">EmbedHoloview</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org930da04">
<h3 id="org930da04">The Plotting</h3>
<div class="outline-text-3" id="text-org930da04"></div>
<div class="outline-4" id="outline-container-orgf6d491f">
<h4 id="orgf6d491f">The Holoviews Embedder</h4>
<div class="outline-text-4" id="text-orgf6d491f">
<div class="highlight">
<pre><span></span><span class="n">SLUG</span> <span class="o">=</span> <span class="s2">"joint-probability-functions"</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"../../files/posts/bayes/"</span><span class="p">)</span><span class="o">/</span><span class="n">SLUG</span>
<span class="n">holoviews</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s2">"bokeh"</span><span class="p">)</span>
<span class="n">Embed</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">EmbedHoloview</span><span class="p">,</span> <span class="n">folder_path</span> <span class="o">=</span> <span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org56b63c0">
<h4 id="org56b63c0">The Plot Settings</h4>
<div class="outline-text-4" id="text-org56b63c0">
<div class="highlight">
<pre><span></span><span class="n">Plot</span> <span class="o">=</span> <span class="n">Namespace</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgd0c1d24">
<h2 id="orgd0c1d24">Middle</h2>
<div class="outline-text-2" id="text-orgd0c1d24">
<p>Although Bayes Rule is often shown as being a binary hypothesis (you have a disease or you don't) with one data input (you tested positive for the disease), in most cases you will have more than one of each. Creating a table of counts/probabilities will make it easier to work with these hypotheses and data.</p>
</div>
<div class="outline-3" id="outline-container-org6a40de0">
<h3 id="org6a40de0">The Joint Probability Function</h3>
<div class="outline-text-3" id="text-org6a40de0">
<p>The <b>Joint Probability Function</b> is the distribution of input and output probabilities for each joint probability. To find the probabilities we need to take measurement counts. If we had two types of data and three hypotheses we could write out our counts in a table like this.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Data</th>
<th class="org-right" scope="col">\(\theta_1\)</th>
<th class="org-right" scope="col">\(\theta_2\)</th>
<th class="org-right" scope="col">\(\theta_3\)</th>
<th class="org-right" scope="col">Sum</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">\(x_1\)</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">3</td>
</tr>
<tr>
<td class="org-left">\(x_2\)</td>
<td class="org-right">1</td>
<td class="org-right">4</td>
<td class="org-right">2</td>
<td class="org-right">7</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Sum</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">3</td>
<td class="org-right">10</td>
</tr>
</tbody>
</table>
<p>The intersection of data and hypothesis is the count we got for our joint probability calculation. To get the actual joint probability we divide the numbers by the total count.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Data</th>
<th class="org-right" scope="col">\(\theta_1\)</th>
<th class="org-right" scope="col">\(\theta_2\)</th>
<th class="org-right" scope="col">\(\theta_3\)</th>
<th class="org-right" scope="col">Sum</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">\(x_1\)</td>
<td class="org-right">0.2</td>
<td class="org-right">0</td>
<td class="org-right">0.1</td>
<td class="org-right">0.3</td>
</tr>
<tr>
<td class="org-left">\(x_2\)</td>
<td class="org-right">0.1</td>
<td class="org-right">0.4</td>
<td class="org-right">0.2</td>
<td class="org-right">0.7</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Sum</td>
<td class="org-right">0.3</td>
<td class="org-right">0.4</td>
<td class="org-right">0.3</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<p>This table represents the <a href="https://en.wikipedia.org/wiki/Joint_probability_distribution?oldformat=true">Joint Probability Distribution</a>.</p>
<p>So if we want to look up the joint probability \(p(x_2, \theta_2)\) for \(x_2\) and \(\theta_2\) in the table we find the intersection of \(x_2\) and \(\theta_2\) in the table and find that it is 0.4. The summary values at the bottom are the <i>marginal likelihood of the hypotheses</i> - e.g. \(p(\theta_2) = 0.4\) and the summary values on the far right are the <i>marginal likelihood of the data</i> - e.g. \(p(x_2) = 0.7\).</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgac78b13">
<h3 id="orgac78b13">Diseases And Symptoms</h3>
<div class="outline-text-3" id="text-orgac78b13">
<p>This next bit comes from the book, I'm just converting it to use pandas. I also changed the indexing to be zero-based, just because.</p>
<p>Suppose you have ten diseases and four symptoms and you count the number of patients that have a disease and a symptom. You can show the Joint Probability as a table.</p>
<div class="highlight">
<pre><span></span><span class="n">joint</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"theta_0"</span><span class="p">,</span> <span class="s2">"theta_1"</span><span class="p">,</span> <span class="s2">"theta_2"</span><span class="p">,</span> <span class="s2">"theta_3"</span><span class="p">,</span> <span class="s2">"theta_4"</span><span class="p">,</span> 
             <span class="s2">"theta_5"</span><span class="p">,</span> <span class="s2">"theta_6"</span><span class="p">,</span> <span class="s2">"theta_7"</span><span class="p">,</span> <span class="s2">"theta_8"</span><span class="p">,</span> <span class="s2">"theta_9"</span><span class="p">],</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">"x_0"</span><span class="p">,</span> <span class="s2">"x_1"</span><span class="p">,</span> <span class="s2">"x_2"</span><span class="p">,</span> <span class="s2">"x_3"</span><span class="p">],</span>
<span class="p">)</span>

<span class="k">assert</span> <span class="n">joint</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">joint</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">37</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">37</span><span class="p">],</span> 
<span class="p">[</span><span class="s2">"x_0"</span><span class="p">,</span> <span class="s2">"x_1"</span><span class="p">,</span> <span class="s2">"x_2"</span><span class="p">,</span> <span class="s2">"x_3"</span><span class="p">])),</span> <span class="n">joint</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">joint</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">200</span>
</pre></div>
</div>
<div class="outline-4" id="outline-container-org1af5f97">
<h4 id="org1af5f97">What is the joint probability that a patient has the symptom \(x_1\) and disease \(\theta_1\) [\(p(x_1, \theta_1)\)]?</h4>
<div class="outline-text-4" id="text-org1af5f97">
<p>To answer this we can look up the value in the row for \(x_1\) and the column for \(\theta_1\) and divide it by the total number of patients.</p>
<div class="highlight">
<pre><span></span><span class="n">total</span> <span class="o">=</span> <span class="n">joint</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">probabilities</span> <span class="o">=</span> <span class="n">joint</span><span class="o">/</span><span class="n">total</span>
<span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">"keys"</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">"orgtbl"</span><span class="p">))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">&nbsp;</th>
<th class="org-right" scope="col">theta_0</th>
<th class="org-right" scope="col">theta_1</th>
<th class="org-right" scope="col">theta_2</th>
<th class="org-right" scope="col">theta_3</th>
<th class="org-right" scope="col">theta_4</th>
<th class="org-right" scope="col">theta_5</th>
<th class="org-right" scope="col">theta_6</th>
<th class="org-right" scope="col">theta_7</th>
<th class="org-right" scope="col">theta_8</th>
<th class="org-right" scope="col">theta_9</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">x_0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0.005</td>
<td class="org-right">0</td>
<td class="org-right">0.015</td>
<td class="org-right">0.025</td>
<td class="org-right">0.05</td>
<td class="org-right">0.035</td>
<td class="org-right">0.035</td>
<td class="org-right">0.02</td>
</tr>
<tr>
<td class="org-left">x_1</td>
<td class="org-right">0</td>
<td class="org-right">0.005</td>
<td class="org-right">0.005</td>
<td class="org-right">0.05</td>
<td class="org-right">0.08</td>
<td class="org-right">0.055</td>
<td class="org-right">0.06</td>
<td class="org-right">0.035</td>
<td class="org-right">0.04</td>
<td class="org-right">0.025</td>
</tr>
<tr>
<td class="org-left">x_2</td>
<td class="org-right">0.015</td>
<td class="org-right">0.025</td>
<td class="org-right">0.04</td>
<td class="org-right">0.045</td>
<td class="org-right">0.07</td>
<td class="org-right">0.05</td>
<td class="org-right">0.015</td>
<td class="org-right">0.015</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-left">x_3</td>
<td class="org-right">0.04</td>
<td class="org-right">0.045</td>
<td class="org-right">0.045</td>
<td class="org-right">0.025</td>
<td class="org-right">0.02</td>
<td class="org-right">0.005</td>
<td class="org-right">0.005</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span><span class="n">intermediate</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"p(x_1, theta_1)"</span><span class="p">:</span> <span class="n">probabilities</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">"x_1"</span><span class="p">,</span> <span class="s2">"theta_1"</span><span class="p">]</span>
<span class="p">}</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"p(x_1, theta_1) = {intermediate['p(x_1, theta_1)']}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
p(x_1, theta_1) = 0.005

</pre></div>
</div>
<div class="outline-4" id="outline-container-orge9b1362">
<h4 id="orge9b1362">What is the probability \(p(x_1)\) that a patient has symptoms \(x_1\)?</h4>
<div class="outline-text-4" id="text-orge9b1362">
<p>You can calculate this by counting all the patients that had symptom \(x_1\) (the sum of the row in the table across all thetas) and dividing by the total sample size.</p>
<div class="highlight">
<pre><span></span><span class="n">intermediate</span><span class="p">[</span><span class="s2">"p(x_1)"</span><span class="p">]</span> <span class="o">=</span> <span class="n">probabilities</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">"x_1"</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"p(x_1) = {intermediate['p(x_1)']:.3f}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
p(x_1) = 0.355

</pre></div>
</div>
<div class="outline-4" id="outline-container-org159f286">
<h4 id="org159f286">What is the probability \(p(\theta_1)\) that a patient has the disease \(\theta_1\)?</h4>
<div class="outline-text-4" id="text-org159f286">
<p>This calculation is similar to calculating the probability of symptom \(x_1\) except instead of using a row total you use the column for \(\theta_1\).</p>
<div class="highlight">
<pre><span></span><span class="n">intermediate</span><span class="p">[</span><span class="s2">"p(theta_1)"</span><span class="p">]</span> <span class="o">=</span> <span class="n">probabilities</span><span class="o">.</span><span class="n">theta_1</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"p(theta_1) = {intermediate['p(theta_1)']}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
p(theta_1) = 0.075

</pre></div>
</div>
<div class="outline-4" id="outline-container-orgcf28d3c">
<h4 id="orgcf28d3c">What is the conditional probability that a patient has the symptom \(x_1\) given that he has the disesase \(\theta_1\)?</h4>
<div class="outline-text-4" id="text-orgcf28d3c">
<p>This is the probability of patients with symptom \(x_1\) in the \(\theta_1\) column divided by the total probability in the \(\theta_1\) column.</p>
<div class="highlight">
<pre><span></span><span class="n">intermediate</span><span class="p">[</span><span class="s2">"p(x_1|theta_1)"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">probabilities</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">"x_1"</span><span class="p">,</span> <span class="s2">"theta_1"</span><span class="p">]</span>
                                  <span class="o">/</span> <span class="n">probabilities</span><span class="p">[</span><span class="s2">"theta_1"</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"p(x_1|theta_1) = {intermediate['p(x_1|theta_1)']:.3f}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
p(x_1|theta_1) = 0.067

</pre></div>
</div>
<div class="outline-4" id="outline-container-orgad57699">
<h4 id="orgad57699">What is the conditional probability that a patent with disease \(\theta_1\) has symptom \(x_1\) (\(p(\theta_1| x_1)\))?</h4>
<div class="outline-text-4" id="text-orgad57699">
<p>Here's where we get to apply Bayes' Rule. \[ p(\theta_1 | x_1) = \frac{p(x_1|\theta_1) p(\theta_1)}{p(x_1)} \]</p>
<div class="highlight">
<pre><span></span><span class="n">intermediate</span><span class="p">[</span><span class="s2">"p(theta_1|x_1)"</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span>
    <span class="n">intermediate</span><span class="p">[</span><span class="s2">"p(x_1|theta_1)"</span><span class="p">]</span> <span class="o">*</span> <span class="n">intermediate</span><span class="p">[</span><span class="s2">"p(theta_1)"</span><span class="p">])</span>
                                  <span class="o">/</span><span class="n">intermediate</span><span class="p">[</span><span class="s2">"p(x_1)"</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"p(theta_1|x_1) = {intermediate['p(theta_1|x_1)']:.3f}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
p(theta_1|x_1) = 0.014

</pre>
<p>But, in fact, you can calculate this a little more directly using:</p>
<p>\[ p(\theta_1|x_1) = \frac{p(x_1, \theta_1)}{p(x_1)} \]</p>
<div class="highlight">
<pre><span></span><span class="n">alternative</span> <span class="o">=</span> <span class="n">intermediate</span><span class="p">[</span><span class="s2">"p(x_1, theta_1)"</span><span class="p">]</span><span class="o">/</span><span class="n">intermediate</span><span class="p">[</span><span class="s2">"p(x_1)"</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Original: {intermediate['p(theta_1|x_1)']:.3}, Alternative: {alternative:.3}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Original: 0.0141, Alternative: 0.0141

</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org6c53bf9">
<h3 id="org6c53bf9">The Probability</h3>
<div class="outline-text-3" id="text-org6c53bf9">
<p>This is a class to generalize what I did above.</p>
<div class="highlight">
<pre><span></span><span class="k">class</span> <span class="nc">JointProbability</span><span class="p">:</span>
    <span class="sd">"""A joint probability inquirer</span>

<span class="sd">    Args:</span>
<span class="sd">     counts: table of counts for joint probability</span>
<span class="sd">     hypothesis: column with the hypothesis counts</span>
<span class="sd">     data: row with the data counts</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">counts</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">hypothesis</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
                 <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="o">=</span> <span class="n">counts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hypothesis</span> <span class="o">=</span> <span class="n">hypothesis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sum_total</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_joint_probability</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_probability</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hypothesis_probability</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_probability_of_data_given_hypothesis</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_probability_of_hypothesis_given_data</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_a_priori</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_probabilities</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sum_total</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">"""The total count of entries in the table"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_total</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sum_total</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_total</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">probabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">"""The counts converted to probabilities"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probabilities</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_probabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">sum_total</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probabilities</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">joint_probability</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">"""the joint probability of the data and hypothesis"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_joint_probability</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_joint_probability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">probabilities</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> 
                                                             <span class="bp">self</span><span class="o">.</span><span class="n">hypothesis</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_joint_probability</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data_probability</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">"""The probability of the data"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_probability</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_probability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">probabilities</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_probability</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hypothesis_probability</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">"""The probability of the hypothesis"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hypothesis_probability</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hypothesis_probability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">probabilities</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hypothesis</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hypothesis_probability</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">probability_of_data_given_hypothesis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">"""The probability of our data given the hypothesis"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probability_of_data_given_hypothesis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_probability_of_data_given_hypothesis</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">probabilities</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hypothesis</span><span class="p">]</span>
                <span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">probabilities</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">hypothesis</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probability_of_data_given_hypothesis</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">probability_of_hypothesis_given_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">"""The probability of our hypothesis given our data"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probability_of_hypothesis_given_data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_probability_of_hypothesis_given_data</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">joint_probability</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">data_probability</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probability_of_hypothesis_given_data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">maximum_a_priori</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">"""The name of the most likely hypothesis"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_a_priori</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_a_priori</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">probabilities</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
                <span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">data_probability</span><span class="p">)</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_a_priori</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgb1f35a6">
<h3 id="orgb1f35a6">Visualize the Maximum A-Priori</h3>
<div class="outline-text-3" id="text-orgb1f35a6"></div>
<div class="outline-5" id="outline-container-org95d58af">
<h5 id="org95d58af">The Probabilities</h5>
<div class="outline-text-5" id="text-org95d58af">
<p>The <i>Maximum A-Priori</i> (MAP) is the hypothesis that has the highest probability given the data.</p>
<p>I wrote the <code>JointProbability</code> class intending it to look at only one theta, but I'll use it again and ignore the theta argument.</p>
<div class="highlight">
<pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">JointProbability</span><span class="p">(</span><span class="n">joint</span><span class="p">,</span> <span class="s2">"theta_1"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">"x_1"</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">Plot</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">likelihood</span> <span class="o">=</span> <span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">"x_1"</span><span class="p">]</span><span class="o">/</span><span class="n">table</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">"p(x1|theta)"</span><span class="p">})</span>
<span class="n">likelihood</span><span class="p">[</span><span class="s2">"theta"</span><span class="p">]</span> <span class="o">=</span> <span class="n">likelihood</span><span class="o">.</span><span class="n">index</span>
<span class="n">likelihood_spikes</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Spikes</span><span class="p">(</span><span class="n">likelihood</span><span class="p">,</span> <span class="n">vdims</span><span class="o">=</span><span class="p">[</span><span class="s2">"p(x1|theta)"</span><span class="p">],</span> <span class="n">kdims</span><span class="o">=</span><span class="p">[</span><span class="s2">"theta"</span><span class="p">])</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
<span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">padding</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
    <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="s2">"hover"</span><span class="p">],</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Likelihood [p(x1|theta)]"</span><span class="p">,</span>
    <span class="n">labelled</span><span class="o">=</span><span class="p">[</span><span class="s2">"y"</span><span class="p">],</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="s2">"bare"</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">prior</span> <span class="o">=</span> <span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">table</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">"p(theta)"</span><span class="p">,</span> <span class="s2">"index"</span><span class="p">:</span> <span class="s2">"theta"</span><span class="p">})</span>
<span class="n">prior</span><span class="p">[</span><span class="s2">"theta"</span><span class="p">]</span> <span class="o">=</span> <span class="n">prior</span><span class="o">.</span><span class="n">index</span>
<span class="n">prior_spikes</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Spikes</span><span class="p">(</span><span class="n">prior</span><span class="p">,</span> <span class="n">vdims</span><span class="o">=</span><span class="p">[</span><span class="s2">"p(theta)"</span><span class="p">],</span> <span class="n">kdims</span><span class="o">=</span><span class="p">[</span><span class="s2">"theta"</span><span class="p">])</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">height</span><span class="p">,</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
    <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="s2">"hover"</span><span class="p">],</span>
    <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">"Prior [p(theta)]"</span><span class="p">,</span>
    <span class="n">labelled</span><span class="o">=</span><span class="p">[</span><span class="s2">"y"</span><span class="p">],</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="s2">"bare"</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">posterior</span> <span class="o">=</span> <span class="p">((</span>
    <span class="p">(</span><span class="n">likelihood</span><span class="p">[</span><span class="s2">"p(x1|theta)"</span><span class="p">]</span> <span class="o">*</span> <span class="n">prior</span><span class="p">[</span><span class="s2">"p(theta)"</span><span class="p">])</span><span class="o">/</span><span class="n">table</span><span class="o">.</span><span class="n">data_probability</span><span class="p">)</span>
             <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"index"</span><span class="p">:</span> <span class="s2">"theta"</span><span class="p">,</span>
                                            <span class="mi">0</span><span class="p">:</span> <span class="s2">"p(theta|x1)"</span><span class="p">}))</span>

<span class="n">posterior_spikes</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">Spikes</span><span class="p">(</span><span class="n">posterior</span><span class="p">,</span> <span class="n">vdims</span><span class="o">=</span><span class="p">[</span><span class="s2">"p(theta|x1)"</span><span class="p">],</span> <span class="n">kdims</span><span class="o">=</span><span class="p">[</span><span class="s2">"theta"</span><span class="p">])</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="n">Plot</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
    <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="s2">"hover"</span><span class="p">],</span>
    <span class="n">xticks</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Posterior [p(theta|x1)]"</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">"theta"</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plot</span> <span class="o">=</span> <span class="p">(</span><span class="n">likelihood_spikes</span> <span class="o">+</span> <span class="n">prior_spikes</span> <span class="o">+</span> <span class="n">posterior_spikes</span><span class="p">)</span><span class="o">.</span><span class="n">cols</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">holoviews</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">"Disease Probabilities for x1"</span>
    <span class="p">),</span>
    <span class="n">holoviews</span><span class="o">.</span><span class="n">opts</span><span class="o">.</span><span class="n">Spikes</span><span class="p">(</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">,</span>
        <span class="n">line_width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"disease_probabilities"</span><span class="p">)()</span>
</pre></div>
<object data="disease_probabilities.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>Looking at the plot you can see that \(\theta_9\) has the highest likelihood (it is the <i>Maximum Likelihood Estimate</i> or MLE), but \(\theta_4\) has the highest posterior probability and so if a person had symptom \(x_1\) we should probably diagnose that he or she has \(\theta_9\).</p>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgfe91eaa">
<h2 id="orgfe91eaa">End</h2>
<div class="outline-text-2" id="text-orgfe91eaa">
<p>Before getting to the testing, it should be noted that the joint probability distribution is generally not available, which is why we need Bayes' Rule. I'm not sure I fully understand that point yet, so I'll just keep reading.</p>
</div>
<div class="outline-3" id="outline-container-org1bcd5e1">
<h3 id="org1bcd5e1">Tests</h3>
<div class="outline-text-3" id="text-org1bcd5e1"></div>
<div class="outline-4" id="outline-container-orge684421">
<h4 id="orge684421">Test Our Example</h4>
<div class="outline-text-4" id="text-orge684421">
<p>These are tests using values from the example.</p>
<div class="highlight">
<pre><span></span><span class="k">class</span> <span class="nc">TestProbability</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">"x1"</span><span class="p">,</span> <span class="n">hypothesis</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">"theta1"</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hypothesis</span> <span class="o">=</span> <span class="n">hypothesis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_p_test</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">p_test</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JointProbability</span><span class="p">:</span>
        <span class="sd">"""The thing under test"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_p_test</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_p_test</span> <span class="o">=</span> <span class="n">JointProbability</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span> 
                                            <span class="n">hypothesis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hypothesis</span><span class="p">,</span>
                                            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_p_test</span>

    <span class="k">def</span> <span class="nf">test_construction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># given an instance of the probability</span>
        <span class="c1"># when the table is retrieved</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_test</span><span class="o">.</span><span class="n">counts</span>
        <span class="c1"># then it is the expected</span>
        <span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">))</span>
        <span class="c1"># and the total is the expected</span>
        <span class="n">expect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_test</span><span class="o">.</span><span class="n">sum_total</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="mi">200</span><span class="p">))</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">test_joint_probability</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># given an instance of the probability</span>
        <span class="c1"># when the p(x1, theta1) is retrieved</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_test</span><span class="o">.</span><span class="n">joint_probability</span>
        <span class="c1"># then it is the expected value</span>
        <span class="n">expect</span><span class="p">(</span><span class="n">isclose</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_true</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">test_data_probabilitiy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Given an instance of the probability</span>
        <span class="c1"># When p(x1) is retrieved</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_test</span><span class="o">.</span><span class="n">data_probability</span>
        <span class="c1"># Then it is the expected value</span>
        <span class="n">expect</span><span class="p">(</span><span class="n">isclose</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="mf">0.355</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_true</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">test_hypothesis_probability</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Given an instance of the probability</span>
        <span class="c1"># When p(theta1) is retrieved</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_test</span><span class="o">.</span><span class="n">hypothesis_probability</span>
        <span class="c1"># Then it is the expected value</span>
        <span class="n">expect</span><span class="p">(</span><span class="n">isclose</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="mf">0.075</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_true</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">test_probability_of_data_given_hypothesis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Given an instance of the probability</span>
        <span class="c1"># When p(x1 | theta1) is retrieved</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_test</span><span class="o">.</span><span class="n">probability_of_data_given_hypothesis</span>
        <span class="c1"># Then it is the expected value</span>
        <span class="n">expect</span><span class="p">(</span><span class="n">isclose</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="mf">0.067</span><span class="p">,</span> <span class="n">abs_tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_true</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">test_probability_of_hypothesis_given_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Given an instance of the probability</span>
        <span class="c1"># When p(theta1 | x1) is retrieved</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_test</span><span class="o">.</span><span class="n">probability_of_hypothesis_given_data</span>
        <span class="c1"># Then it is the expected value</span>
        <span class="n">expect</span><span class="p">(</span><span class="n">isclose</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="mf">0.014</span><span class="p">,</span> <span class="n">abs_tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">be_true</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">test_maximum_a_priori</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Given an instance of the probability</span>
        <span class="c1"># When the MAP is retrieved</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_test</span><span class="o">.</span><span class="n">maximum_a_priori</span>
        <span class="c1"># Then it is the expected label</span>
        <span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="s2">"theta4"</span><span class="p">))</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">(</span><span class="n">thing</span> <span class="k">for</span> <span class="n">thing</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">if</span> <span class="n">thing</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">"test_"</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">test</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test</span><span class="p">)()</span>
        <span class="k">return</span>

<span class="n">test</span> <span class="o">=</span> <span class="n">TestProbability</span><span class="p">(</span><span class="n">joint</span><span class="p">)</span>
<span class="n">test</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgb0907a5">
<h4 id="orgb0907a5">Test Hypothesis</h4>
<div class="outline-text-4" id="text-orgb0907a5">
<p>Now for some <a href="https://hypothesis.readthedocs.io/en/latest/numpy.html#pandas">Pandas hypothesis testing</a>.</p>
<div class="highlight">
<pre><span></span><span class="k">class</span> <span class="nc">TestHypothesis</span><span class="p">:</span>
    <span class="nd">@given</span><span class="p">(</span><span class="n">data_frames</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
                       <span class="n">index</span><span class="o">=</span><span class="n">range_indexes</span><span class="p">(</span><span class="n">min_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
    <span class="k">def</span> <span class="nf">test_total_sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># given a JointProbability instance</span>
        <span class="n">test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

        <span class="c1"># when the sum_total is retrieved</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">sum_total</span>

        <span class="c1"># then it is the expected value</span>
        <span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
        <span class="k">return</span>

    <span class="nd">@given</span><span class="p">(</span><span class="n">data_frames</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
                       <span class="n">index</span><span class="o">=</span><span class="n">range_indexes</span><span class="p">(</span><span class="n">min_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
    <span class="k">def</span> <span class="nf">test_joint_probability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># given a JointProbability instance</span>
        <span class="n">test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

        <span class="c1"># when the joint probability is retrieved</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">joint_probability</span>

        <span class="c1"># then it is the expected value</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="n">tester</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">tester</span><span class="o">.</span><span class="n">hypothesis</span><span class="p">]</span><span class="o">/</span><span class="n">tester</span><span class="o">.</span><span class="n">sum_total</span>
        <span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span>
            <span class="n">equal</span><span class="p">(</span><span class="n">expected</span><span class="p">))</span>
        <span class="k">return</span>

    <span class="nd">@given</span><span class="p">(</span><span class="n">data_frames</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
                       <span class="n">index</span><span class="o">=</span><span class="n">range_indexes</span><span class="p">(</span><span class="n">min_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
    <span class="k">def</span> <span class="nf">test_data_probabilitiy</span><span class="p">(</span><span class="n">table</span><span class="p">):</span>
        <span class="c1"># given a JointProbability instance</span>
        <span class="n">test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

        <span class="c1"># when the probability of the data is retrieved</span>
        <span class="n">test</span><span class="o">.</span><span class="n">data_probability</span>

        <span class="c1"># then it is the expected value</span>
        <span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span>
            <span class="n">equal</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test</span><span class="o">.</span><span class="n">data</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">sum_total</span><span class="p">))</span>
        <span class="k">return</span>

    <span class="nd">@given</span><span class="p">(</span><span class="n">data_frames</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
                       <span class="n">index</span><span class="o">=</span><span class="n">range_indexes</span><span class="p">(</span><span class="n">min_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
    <span class="k">def</span> <span class="nf">test_hypothesis_probabilitiy</span><span class="p">(</span><span class="n">table</span><span class="p">):</span>
        <span class="c1"># Given a JointProbability instance    </span>
        <span class="n">test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

        <span class="c1"># When the probability of the hypothesis is retrieved</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">hypothesis_probability</span>

        <span class="c1"># Then it is the expected value</span>
        <span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span>
            <span class="n">test</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">test</span><span class="o">.</span><span class="n">hypothesis</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">sum_total</span>
        <span class="p">))</span>
        <span class="k">return</span>

    <span class="nd">@given</span><span class="p">(</span><span class="n">data_frames</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
                       <span class="n">index</span><span class="o">=</span><span class="n">range_indexes</span><span class="p">(</span><span class="n">min_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
    <span class="k">def</span> <span class="nf">test_probabilitiy_of_data_given_hypothesis</span><span class="p">(</span><span class="n">table</span><span class="p">):</span>
        <span class="c1"># Given a JointProbability instance</span>
        <span class="n">test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

        <span class="c1"># When p(data | hypothesis) is retrieved</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">probability_of_data_given_hypothesis</span>

        <span class="c1"># Then it is the expected data</span>
        <span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span>
            <span class="n">test</span><span class="o">.</span><span class="n">joint_probability</span><span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">hypothesis_probability</span>
        <span class="p">))</span>
        <span class="k">return</span>

    <span class="nd">@given</span><span class="p">(</span><span class="n">data_frames</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
                       <span class="n">index</span><span class="o">=</span><span class="n">range_indexes</span><span class="p">(</span><span class="n">min_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
    <span class="k">def</span> <span class="nf">test_probabilitiy_of_hypothesis_given_data</span><span class="p">(</span><span class="n">table</span><span class="p">):</span>
        <span class="c1"># Given a JointProbability instance</span>
        <span class="n">test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

        <span class="c1"># When p(hypothesis | data) is retrieved</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">probability_of_hypothesis_given_data</span>

        <span class="c1"># Then it is the expected value</span>
        <span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span>
            <span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">probability_of_data_given_hypothesis</span> 
             <span class="o">*</span> <span class="n">test</span><span class="o">.</span><span class="n">probability_of_hypothesis</span><span class="p">)</span><span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">probability_of_data</span>
        <span class="p">))</span>
        <span class="k">return</span>

    <span class="nd">@given</span><span class="p">(</span><span class="n">data_frames</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
                       <span class="n">index</span><span class="o">=</span><span class="n">range_indexes</span><span class="p">(</span><span class="n">min_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
    <span class="k">def</span> <span class="nf">test_maximum_a_priori</span><span class="p">(</span><span class="n">table</span><span class="p">):</span>
        <span class="c1"># Given a JointProbability instance</span>
        <span class="n">test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

        <span class="c1"># When the MAP is retrieved</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">maximum_a_priori</span>

        <span class="c1"># Then it is the expected value</span>
        <span class="n">best_column</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">best_so_far</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">test</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">probability</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">probabilities</span><span class="p">[</span>
                <span class="n">test</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">hypothesis</span><span class="p">]</span><span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">probability_of_data</span>
            <span class="k">if</span> <span class="n">probability</span> <span class="o">&gt;</span> <span class="n">best_column</span><span class="p">:</span>
                <span class="n">best_column</span> <span class="o">=</span> <span class="n">column</span>
        <span class="n">expect</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">equal</span><span class="p">(</span><span class="n">best_column</span><span class="p">))</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">get_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JointProbability</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>
        <span class="n">hypothesis</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">JointProbability</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">hypothesis</span><span class="o">=</span><span class="n">hypothesis</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_total_sum</span><span class="p">()</span>
        <span class="k">return</span>

<span class="n">test_hypothesis</span> <span class="o">=</span> <span class="n">TestHypothesis</span><span class="p">()</span>
<span class="n">test_hypothesis</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org9992488">
<h3 id="org9992488">Source</h3>
<div class="outline-text-3" id="text-org9992488">
<ol class="org-ol">
<li>Stone JV. Bayesâ€™ rule: a tutorial introduction to Bayesian analysis. First edition, third printing [with corrections]. Sheffield: Sebtel Press; 2014. 170 p.</li>
</ol>
</div>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../../categories/bayes/" rel="tag">bayes</a></li>
<li><a class="tag p-category" href="../../../categories/probability/" rel="tag">probability</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../the-pox-probabilities/" rel="prev" title="The Pox Probabilities">Previous post</a></li>
<li class="next"><a href="../../interesting-sources/" rel="next" title="Interesting Sources">Next post</a></li>
</ul>
</nav>
</aside>
</article>
<!--End of body content-->
<footer id="footer">Contents Â© 2019 <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="../../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
</script>
</body>
</html>
